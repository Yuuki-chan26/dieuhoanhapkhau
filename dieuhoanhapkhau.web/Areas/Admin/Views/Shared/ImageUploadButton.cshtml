
@model string
@{
    var id = "id" + Math.Abs(Guid.NewGuid().GetHashCode()).ToString();


}
<input type="button" id="btn-@id" value="Upload" />


<script type="text/javascript">

	$('#btn-@id').click(function () {

		$('#globalUploadFileInput').trigger('click');
		$('#globalUploadFileInput').unbind('change').bind('change', function () {
			var formData = new FormData($('#globalUploadFile')[0]);
			$.ajax({
				url: '@Url.Action("UploadImage", "Home")',
			type: 'POST',
			xhr: function () {  // Custom XMLHttpRequest
				var myXhr = $.ajaxSettings.xhr();
				if (myXhr.upload) { // Check if upload property exists
					//myXhr.upload.addEventListener('progress', progressHandlingFunction, false); // For handling the progress of the upload
				}
				return myXhr;
			},
			//Ajax events
			beforeSend: function () {
				$('#img_@Model').attr('src', '~/Images/loading.png');

			},
			success: function (data) {

				$('#@Model').val(data.Url);
				$('#img_@Model').attr('src',data.Url);
			},
			error: function (e) {
				alert(e);

			},
			// Form data
			data: formData,
			//Options to tell jQuery not to process data or worry about content-type.
			cache: false,
			contentType: false,
			processData: false
		});
		});


		return false;

	});




</script>

